Initializing Financial Data Ingestor...
Building FAISS index for semantic validation...

âœ“ Ingestor ready!

================================================================================
RUNNING EXAMPLE QUERIES
================================================================================


EXAMPLE 1/1
--------------------------------------------------------------------------------
================================================================================
INGESTING: Show me Apple's daily stock price for the last 30 days
================================================================================

[1/5] Analyzing query with LLM...
  âœ“ Features:
    - Native: ['open', 'high', 'low', 'close', 'volume']
    - Enrichment: []
  âœ“ Semantic Keywords: ['daily', 'price', 'stock', 'historical', 'AAPL', 'last 30 days', 'OHLCV']
  âœ“ LLM selected 2 endpoint(s):
    - polygon.get_aggs
    - alpha_vantage.TIME_SERIES_DAILY

[2/5] Building execution plan...
  âœ“ Created 2 request(s)

[3/5] Validating endpoints semantically (FAISS)...
  Validating that endpoints can provide: ['open', 'high', 'low', 'close', 'volume']
  âœ— polygon.get_aggs: score=0.40, status=ERROR
  âœ— alpha_vantage.TIME_SERIES_DAILY: score=0.45, status=ERROR

[4/5] Validating parameters...

[5/5] Executing API calls...
  â†’ Calling polygon.get_aggs
  âœ“ Success: 22 rows Ã— 10 columns
  â†’ Calling alpha_vantage.TIME_SERIES_DAILY
  âœ“ Success: 100 rows Ã— 7 columns
  âœ“ Status: COMPLETE
  âœ“ Successful: 2

================================================================================
COMPLETED in 27232ms
Returned 2 dataset(s)

Validation Reports:
  1. polygon.get_aggs âœ“ PASSED
     Ticker: AAPL
     Found: ['open', 'high', 'low', 'close', 'volume']
  2. alpha_vantage.TIME_SERIES_DAILY âœ“ PASSED
     Ticker: AAPL
     Found: ['open', 'high', 'low', 'close', 'volume']

Enrichment features: []
Key features (query intent): ['AAPL', 'daily', 'price', 'stock', 'historical', 'last 30 days', 'OHLCV']
================================================================================


ðŸ“Š RESULTS:

Enrichment Features: []
Key Features (Query Intent): ['AAPL', 'daily', 'price', 'stock', 'historical', 'last 30 days', 'OHLCV']

ðŸ“‹ Validation Reports:

  Report 1: âœ“ PASSED
    API: polygon
    Endpoint: get_aggs
    Ticker: AAPL
    Found features: ['open', 'high', 'low', 'close', 'volume']
    Actual columns: ['ticker', 'open', 'high', 'low', 'close', 'volume', 'vwap', 'timestamp', 'transactions', 'otc']

  Report 2: âœ“ PASSED
    API: alpha_vantage
    Endpoint: TIME_SERIES_DAILY
    Ticker: AAPL
    Found features: ['open', 'high', 'low', 'close', 'volume']
    Actual columns: ['ticker', 'timestamp', 'open', 'high', 'low', 'close', 'volume']

ðŸ“ˆ DataFrames:

  Dataset 1:
    Shape: (22, 10)
    Columns: ['ticker', 'open', 'high', 'low', 'close', 'volume', 'vwap', 'timestamp', 'transactions', 'otc']

    First 5 rows:
  ticker     open     high  ...                 timestamp  transactions   otc
0   AAPL  255.885  264.375  ... 2025-10-20 04:00:00+00:00       1160822  None
1   AAPL  261.880  265.290  ... 2025-10-21 04:00:00+00:00        714945  None
2   AAPL  262.650  262.850  ... 2025-10-22 04:00:00+00:00        687110  None
3   AAPL  259.940  260.620  ... 2025-10-23 04:00:00+00:00        482428  None
4   AAPL  261.190  264.130  ... 2025-10-24 04:00:00+00:00        599532  None

[5 rows x 10 columns]

  Dataset 2:
    Shape: (100, 7)
    Columns: ['ticker', 'timestamp', 'open', 'high', 'low', 'close', 'volume']

    First 5 rows:
  ticker                 timestamp     open  ...       low   close    volume
0   AAPL 2025-06-30 00:00:00+00:00  202.010  ...  199.2607  205.17  91912816
1   AAPL 2025-07-01 00:00:00+00:00  206.665  ...  206.1401  207.82  78788867
2   AAPL 2025-07-02 00:00:00+00:00  208.910  ...  208.1400  212.44  67941811
3   AAPL 2025-07-03 00:00:00+00:00  212.145  ...  211.8101  213.55  34955836
4   AAPL 2025-07-07 00:00:00+00:00  212.680  ...  208.8000  209.95  50228984

[5 rows x 7 columns]

================================================================================


================================================================================
USAGE GUIDE
================================================================================

You can now use the ingestor with any custom query:

  dataframes, enrichment, key_features, reports = ingestor.process('your query here')

Examples:
  â€¢ dataframes, enrichment, key_features, reports = ingestor.process('Get IBM daily prices')
  â€¢ dataframes, enrichment, key_features, reports = ingestor.process('Show GDP data')
  â€¢ dataframes, enrichment, key_features, reports = ingestor.process('Apple with SMA_20')

The function returns:
  1. dataframes: List of pandas DataFrames with the data
  2. enrichment_features: List of technical indicators (e.g., ['SMA_20', 'RSI_14'])
  3. key_features: List modeling query intent (tickers + keywords + enrichment)
  4. validation_reports: List of ValidationReport objects

================================================================================
